# Barrier options analysis app


---
## I. Purpose of making:
The app was created as a tool for graphical analysis on the impact of various parameters used in barrier options (more on them in the theoretical chapter). Since those exotic options do not have exact formulas for their prices, it is hard to fully understand how they rely on characteristics such as volatility, strike price, early exercise possibility, dividend yield etc. (especially with multiple of them changing). Therefore, the following project provides a reliable numerical pricing model with a range of interactive visualizations not only of the prices in time but also of f. e. early exercise possibilities for american variants. It graphically explains various peculiarities of barrier options which would be practically impossible to spot by looking only at the market charts.
## II. Theoretical background:
### 1. Concept of an option:
Although words "analysis" and "app" don't need to be explained, something probably needs to be said about barrier options itself. Starting with an "option" term: it is a financial instrument from a wide and especially interesting group of derivatives. As all derivivatives, options rely on some other financial instrument for example stock- this base instrument is called an underlying. Then, there is an agreement between a buyer and a seller of an option on some kind of a trade connected to the underlying. Depending on the type of agreement, options diverge into multiple classes. In the most basic scenario (where option is called a *vanilla* one), purchaser (let's call him person A) has an OPTION (a chance) to buy/sell (call option/put option) the underlying for predetermined price (strike price) on/before (european option/american option) some predetermined date in future (expiration date). Therefore, seller (person B) has an OBLIGATION to provide/buy this specific instrument (as agreed) if the person A will want that. Obviously person A is only going to f. e. buy the underlying (if he's the owner of a call option) if the market price that day will be higher than the agreed strike price- otherwise he won't do anything and contract expires. It can be clearly seen that the agreement puts the seller of the option in worse position, that is why there needs to be a certain price set to buy the option in the first place. But how to derive that price such that it will be equivalent for the risk that each side takes? That where the whole theory of pricing options comes in, let's just say that those prices can be calculated throught solving a stochastic (probabilistic) equation called the Black-Scholes equation. Luckily someone already solve it and for those vanilla (most standard) options we have an exact formulas- we can just substitute all previously mentioned parameters (terms of the agreement) and some market characteristics to get the most fair price possible. But as already mentioned, vanilla options are just a varriant of all possible options types (the non-vanilla ones are called exotic) and if the rules get more complicated, the equation also does. Since that, there are no exact formulas for various types of options, especially for the ones that are the main subject of this project- barrier options.
### 2. Barrier options:
We already know what an option is- now let's imagine that we're the seller of a standard call option on stock (buyer will have the possibility to buy that stock). We've agreed on the strike price K=100 and expiration date at exactly T=1 year from now. After half of a year we see that the price of the underlying is flying and already hit 500. There is a huge chance that the current owner of the option will use his chance to buy the stock for just K=100 and it will result in us losing a lot of money (even more than 400 if the price will keep on going up). To prevent this practically unlimited lose barrier options were introduced. As the name suggests there is a predetermined barrier price for the underlying, if it is going to be hit before the expiration date, the contract will expire automatically. Therefore, if the option we began with was a barrier one with barrier B=500, we wouldn't have to worry about the price going up cause the option would stop existing right after hitting that level (then we would even profit from it since the option costed something).\
Barrier options can be seen as standard vanilla ones but with a certain barrier level which, if hitted by the underlying, will expire the contract automatically. Usually for barrier call option the level is set above the strike price and for a put one- below it. In the previous part we only quickly mentioned the american options- the possibility of buying/selling can be used not only at the expiration date but also before it. Therefore a smart owner of american barrier option will probably exercise it if the underlying gets really close to the barrier.\
Since barrier options don't have exact formulas for the prices we need to solve the stochastic equation explaining them numerically (by some discretizations and approximations)- our exact method is called Finite Difference.
### 3. Finite Difference method:
This numerical method is based on approximating derivatives using Taylor's series. Black Scholes equation is dependend on time and the value of underlying in that time. We can construct a rectangular grid with *t* on X axis (from 0 to the expiration time T) and *S(t)* on Y axis (with a suitable range). Then each point on the grid will represent a hypothetical moment before (or at) expiration date with a specific price of underlying. We're going to fill those points with corresponding values of the option. It usually the case that right border (t=T) and one of upper/lower ones can be filled automatically. For example price of a standard call option at expiration date (right border) is just max(S(T)-K;0) where K is strike price and 0 comes from the fact that an owner of one won't exersise the contract if the difference will be negative. Since we're making Finite Difference model especially for barrier options, one of the horizontal borders is the barrier itself with all points equal to 0 (cause there the contract expires automatically). Once we have some of those borders point filled we can sequentially fill the rest of them going from right to left based on the Black-Scholes equation. As mentioned, all the derivatives used in this equation are substituted with discreet differential quotients on the already calculated points. Thanks to that algorithm we can fill in all of the points on our rectangle. Keep in mind that it's a numerical approach thus it is biased, obviously the more dense the grid is, the more accurate results we obtain.

## III. Programming background
The whole project was created in R, it's main part relies heavily on the *shiny* library (for running the app) and *ggplot2* one (for all of the visuals). Everything was splitted into two separate applications: one for heatmaps visualizations and other for more more time dependend graphics (for example plots on how the the influence of current underlying value on option price changes as time passes). The split was made due to the complexity of calculations- each of this apps can be used separately but they both require file *to_run.R* to be run before. The biggest drawback of the whole project is the loading time of plots. Since we require a really dense grid for the Finite Difference (especially for more complicated barrier options), there is a lot of data to prepare for the *ggplot2* library after each change of any parameter. Therefore if some plot is not loading give it more time cause it's usually not an error but multiple calculations performing in the background. Also, when changing the parameters using sliders avoid sliding (cause it will probably calculate the results for each parameter u passed) and just click on the value u want to change parameter to. I don't think changing values before something loads will broke the app but the program (R) can stop responding if you give him to much to do at once.\
*Note: unfortunetely all of the comments in code and the whole app is in polish (atm). If you're an English speaking person and want to understand more of what's going on, let me know and I will change everything to english (comments and labels in the app itself).*
## IV. Instructions
1. Install (or update) all libraries from *requirements.txt*.
2. Run 'to_run.R'.
3. Pick one of the apps.
4. Open both *server.R* and *ui.R* and run the app from any of those files.
6. Wait for the initial plot to load.
7. Explore.
*Note: As mentioned before, feel free to contact me if anything is problematic- both from the programming perspective and a theoretical one.*
